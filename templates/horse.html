<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{url_for('static', filename='styles/styles.css')}}">
    <title>{{horse.name}}</title>
</head>


    {% extends 'index.html' %}
    {%block content%}
   
        <div class="d-flex  align-items-start">
            <div class="">
                <section id="left_bar" class="ms-5 mt-5 ">
                    {% if horse_images|count > 0 %}
                    {% set selected_photo = horse_images|random %}
                    <div>
                        <img src={{selected_photo["url"]}} class="img-thumbnail" width="150px" alt="..." />
                    </div>
                    {% endif %}
                    <div>
                        <h5>Name: {{horse.name}}</h5>
                        <h5>Sex: {{horse.sex}}</h5>
                        <h5>Breed: {{horse.breed}}</h5>
                        <h5>Color: {{horse.color}}</h5>
                        <h5>Height:{{horse.height}}</h5>
                        <h5>Age: {{horse.age}}</h5>
                        <h5>Asking Price:
                            {%if horse.price > 1 %}
                            ${{horse.price}}0
                            {%else%}
                            Not For Sale
                            {%endif%}
                        </h5>
                        {%if current_user.is_authenticated%}
                        <button id="update_horse_btn" class="btn btn-info">Update {{horse.name}}'s Info</button>
                        {% endif%}
                    </div>                   
                </section>       
            </div>
            
            <div class=" w-75 align-content-center"> 
                <section  id="horse_info" class="col">
                    <hr class="mx-auto mt-5 w-50"
                        style="border-bottom: none; border-top: 15px dotted #00edff; background: none">
                    <div class="container mt-3 p-5">
                        <div class="text-center">
                            <h3>About {{horse.name}}</h3>
                        </div>
                        <div class="w-75 mx-auto mt-4">
                            <h5 class="lh-lg">{{horse.bio}}</h5>
                        </div>
                    </div>
                </section>          
                <section id="training" class=" mt-3 mb-5 p-5">
                            <hr class="mx-auto mt-5 w-50"
                            style="border-bottom: none; border-top: 15px dotted #00edff; background: none">
                            <div class="text-center">
                                <h3>Training</h3>
                            </div>
                            <div class="w-50 mx-auto mt-4">
                                <div class="text-center mb-4">
                                    <h5>Trainers: David Jones, Dwight Mobley</h5>
                                </div>
                                <div class="mx-auto text-start" style="width: 65%;">
                                    {% for line in horse.training.split(".") %}
                                    {% if line != ""%}
                                    <li class="my-2">{{line}}</li>
                                    {%endif%}
                                    {% endfor %}
                                </div>
                            </div>
                </section>                                
                <section id="gallery" class=" mt-3 mb-5 mx-auto">
                            <hr class="mx-auto w-50"
                            style="border-bottom: none; border-top: 15px dotted #00edff; background: none">
                            <div class="text-center">
                                <h3>Gallery</h3>
                            </div>
                            <div class="d-flex flex-wrap w-75 mx-auto mt-4 border border-1">
                                {%for image in horse_images%}
                                <button class='card p-2 m-2 w-25 horse_btn' data-bs-toggle="modal"
                                    data-bs-target="#large_horse_modal">
                                    <img class='card-img-top' src={{image.url}} alt="horse image" />
                                    <p class='card-text'>{{image.comment}}</p>
                                </button>
                                {% endfor %}
                            </div>
                </section>
            </div>
        </div>

   
    
    
                        
        <!-- Horse Modal -->
        <div id="large_horse_modal" class="modal">
            <div class="modal-dialog modal-dialog-centered ">
                <div class="modal-body">
                    <img id="big_image" src="" alt="horse image"
                        class="rounded position-fixed top-50 start-50 translate-middle" width="1000em" />
                </div>
            </div>
        </div>   

    <!-- FORM TO UPDATE HORSE -->
    <form enctype="multipart/form-data" id="update_horse_form" action="{{url_for('update_horse')}}" method="POST"
        class="w-50 shadow-lg p-3 position-absolute start-50 translate-middle" style="visibility:hidden; top:85%">
        <h2 class="text-center">Update {{horse.name}}'s Information</h2>
        <input type="hidden" name="id" value={{horse.id}} <div class="row mx-auto">
        <div class="form-floating mb-3 w-50 mx-auto row">
            <input name="name"" type=" text" class="form-control" id="update_name" value="{{horse.name}}">
            <label for="name">Name</label>
        </div>
        <div class="form-floating mb-3  w-50 mx-auto row">
            <input name="breed"" type=" text" class="form-control" id="update_breed" value="{{horse.breed}}">
            <label for="breed">Breed</label>
        </div>
        </div>


        <div class="row   mx-auto">
            <div class="form-floating mb-3 col">
                <input name="color"" type=" text" class="form-control" id="update_color" value="{{horse.color}}">
                <label for="color">Color</label>
            </div>
            <div class="form-floating mb-3  w-50 mx-auto col">
                <input name="saddle_time"" type=" text" class="form-control" id="update_saddle_time"
                    value="{{horse.saddle_time}}">
                <label for="saddle_time">Saddle Time</label>
            </div>
        </div>

        <div class="row  mx-auto justify-content-left">
            <div class="form-floating mb-3 col">
                <input name="sex"" type=" text" class="form-control" id="update_sex" value="{{horse.sex}}">
                <label for="sex">Sex</label>
            </div>
            <div class="form-floating col">
                <input name="age"" type=" number" class="form-control" id="update_age" value={{horse.age}}>
                <label for="age">Age</label>
            </div>
            <div class="form-floating mb-3 col">
                <input name="height"" type=" float" class="form-control" id="update_height" value={{horse.height}}>
                <label for="height">Height</label>
            </div>
        </div>

        <div class="form-floating mb-3 col w-25 mx-auto">
            <input name="price"" type=" float" class="form-control" id="update_price" value={{horse.price}}>
        </div>
        <div class="form-floating mb-3">
            <textarea name="training" class="form-control" rows="20" style="height: 100%;"
                placeholder="Enter Completed Training. Place a Period for a new line."
                id="update_training">{{horse.training}}</textarea>
            <label for="training">Enter Training Accomplishments. Periods Start New Bullet Points</label>
        </div>
        <div class="form-floating mb-3">
            <textarea name="bio" class="form-control" rows="20" style="height: 100%;" placeholder="Enter Bio"
                id="update_bio">{{horse.bio}}</textarea>
            <label for="training">Enter Bio</label>
        </div>
        <div class="form-floating mb-3">
            <input name="images" type="file" class="form-control" multiple>
        </div>
        <div class='row mb-5'>
            <div class="form-floating col">
                <input type="submit" class="form-control btn btn-info" />
            </div>
            <div class="form-floating col">
                <button type="button" class="form-control btn btn-danger cancel_btn">Cancel</button>
            </div>
        </div>
    </form>


    <script>
        let update_horse_btn = document.getElementById('update_horse_btn')
        let cancel_button = document.getElementsByClassName("cancel_btn")[0]
        let horse_info = document.getElementById("horse_info")
        update_horse_btn.onclick = function () {
            update_horse_form.style.visibility = "visible"
            horse_info.style.visibility = "hidden"
        }

        cancel_button.onclick = function () {
            update_horse_form.style.visibility = 'hidden'
            horse_info.style.visibility = "visible"


            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }

        horse_btns = document.getElementsByClassName("horse_btn")
        Array.from(horse_btns).forEach(function (button) {
            button.onclick = function (event) {
                console.log(event.target)
                document.getElementById("big_image").src = event.target.src
            }
        })
    </script>

    {%endblock%}



</body>

</html>